# Withs

Withs используется в методах получения данных, в частности в getItems, для того, 
чтобы получать данные по имеющимся relations модели, указанным в метаданных.

Пример использования `withs`. (Получаем сотрудника с его отделом и ролями)

Запрос: `domain/Service/Employee/getItem/1`

JSON payload

```json
{
  "withs": [
    ["department", "roles"]
  ]
}
```

### Использование агрегатных функций

Список доступных агрегатных функций:`avg`, `count`, `min`, `max`, `exists`, `sum`. Подробнее о функциях можно почитать 
в [документации Laravel](https://laravel.com/docs/8.x/queries#aggregates).

В качестве входного параметра агрегатной функции можно указать атрибут связанной модели 
(например, `relation.max(id)` будет выполнять вычислять максимальное значения среди `id`).

Пример получения отделов и количества сотрудников в каждом с помощью агрегатной функции.

Запрос: `domain/Service/Department/getItems`

JSON payload

```json
{
  "withs": [
    ["users.count()"]
  ]
}
```
