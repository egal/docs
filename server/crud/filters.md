# Фильтры

Фильтрация используется в методах получения данных, в частности в
getItems.

Пример фильтрации с группировкой. (Ищем сотрудника с email
"ivanov_ivan@domain.com" или Его имя "Иван" и возраст больше 20)

JSON payload

```json
{
  "filter": [
    ["email", "eq", "ivanov_ivan@domain.com"],
   "OR",
    [
      ["full_name", "co", "Иван"],
      "AND",
      ["email", "ge", 20]
    ]
  ]
}
```

Таблица соответствий фильтров и sql операций

| Оператор | Описание                                                                                                      | Пример в SQL                          |
|:--------:|:--------------------------------------------------------------------------------------------------------------|:--------------------------------------|
|   `eq`   | Ищет точное соответствие                                                                                      | `"full_name"="Иванов Иван Иванович"`  |
|   `ne`   | Возвращает строки которые не ровны значению                                                                   | `"full_name"!="Иванов Иван Иванович"` |
|   `gt`   | Возвращает строки в которых значение поля больше значения аргумента (см. правила сравнения типов данных в бд) | `"price" > 1000`                      |
|   `lt`   | Возвращает строки в которых значение поля меньше значения аргумента                                           | `"price" < 1000`                      |
|   `ge`   | Возвращает строки в которых значение поля больше или ровно значения аргумента                                 | `"price" >= 1000`                     |
|   `le`   | Возвращает строки в которых значение поля меньше или ровно значения аргумента                                 | `"price" <= 1000`                     |
|   `co`   | Возвращает строки в которых значение поля содержит частичное соответствие искомой строки                      | `"full_name" LIKE "%Иван%"`           |
|   `nc`   | Возвращает строки в которых значение поля не содержит частичное соответствие искомой строки                   | `"full_name" NOT LIKE "%Иван%"`       |
|   `sw`   | Возвращает строки в которых значение поля начинается с искомой строки                                         | `"full_name" LIKE "Иван%"`            |
|   `ew`   | Возвращает строки в которых значение поля оканчивается искомой строкой                                        | `"full_name" LIKE "%Иван"`            |
|   `or`   | Оператор логическое ИЛИ. Используется для составления более сложных условий                                   | `"price" > 1000 OR "price" < 2000`    |
|  `and`   | Оператор логическое И. Используется для составления более сложных условий                                     | `"price" > 1000 AND "price" < 2000`   |


### Фильтрация по связанным сущностям

`["[relation_name].[field_name]", "operator", "value"]`

Фильтрация по отношению выполняется через обращение к названию отношения
(прописанного в метаданных).

> :warning: Для фильтрации по отношениям должен быть указан
> соответствующий `property-type` у `property`. Смотри
> [документацию](/server/metadata.md#Перечень-тегов).

Пример поиска сотрудников по названию отдела.

Запрос: `domain/Service/Employee/getItems`

JSON payload

```json
{
  "filter": [
    ["departments.name", "eq", "Отдел маркетинга"]
  ]
}
```

